(function(b){function B(){c.remove();f.remove();d.remove()}function C(){h=Math.min(p>e-a?(e-a)/(p+a):1,q>j-a?(j-a)/(q+a):1);u=p*h;v=q*h;k.animate({width:u,height:v},300);r=e/2-(u+a/2)/2;l=j/2-(v+a/2)/2+m.scrollTop();0<b("#"+D).length&&(l-=F/2);c.animate({left:r,top:l},200)}function G(){f.width(e).height(s);C()}function H(a){a.preventDefault();f=b("<div />").attr("id",I).css(w).css({"z-index":x,"background-color":J});f.on("click",B);t.append(f);f.fadeTo(1,0);f.width(e).height(s);f.fadeTo(300,0.8); d=b("<div>Loading...</div>").attr("id",K).css(w).css({"z-index":x+1});t.append(d);d.fadeTo(1,0);r=e/2-d.width()/2;l=j/2-d.height()/2+m.scrollTop();d.css({left:r,top:l});d.fadeTo(100,1);var g=a.data.src,h=a.data.title;k=b("<img />").attr("src",g).attr("alt",h).on("load", function(){c=b("<div />").attr("id",n).css(w).css({"z-index":x+2,"font-size":0,border:"3px solid "+E,"background-color":E,top:j/2,left:e/2});void 0!==h&&c.append(b("<div>"+h+"</div>").attr("id",D).css({"font-size":"10pt",padding:"2px"})); c.append(k).on("click",B);t.append(c);c.fadeTo(1,0.1);p=k.width();q=k.height();k.width(0).height(0);C();c.fadeTo(600,1);d.remove()})}var m,g,t,p,q,e,j,s,n="imageDialog",I=n+"Overlay",K=n+"Loading",D=n+"Title",F=14,a=30,E="#fff",J="#444\t",x=1E4,y,z,h,u,v,r,l,A,w={position:"absolute",display:"none",top:"0",left:"0"},d,f,c,k;b.fn[n]=function(){m=b(document);g=b(window);t=b("body");s=m.height();e=g.width();j=g.height();return this.each(function(){var a=b(this);y=a.data("full-img");z=a.attr("title"); void 0!==y&&(a.on("click",{src:y,title:void 0!==z?z:a.attr("alt")},H).css({cursor:"pointer"}),g.on("resize scroll orientationchange",function(){s=m.height();e=g.width();j=g.height();A&&clearTimeout(A);void 0!==c&&(A=setTimeout(G,100))}))})}})(jQuery);